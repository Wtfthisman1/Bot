# Telegram Bot with Whisper Transcription

Telegram –±–æ—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ –∏ –∏—Ö —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é Whisper AI.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone <your-repo-url>
cd Bot
```

2. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª:**
```bash
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

3. **–°–æ–±–µ—Ä–∏—Ç–µ JAR –ª–æ–∫–∞–ª—å–Ω–æ:**
```bash
./gradlew build
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞:**
```bash
./build-and-run.sh full
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

#### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ Docker Compose:**
```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER
```

2. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
```bash
git clone <your-repo-url>
cd Bot
```

3. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
cp env.example .env
# –î–æ–±–∞–≤—å—Ç–µ BOT_TOKEN, ADMIN_CHAT_ID –∏ –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD

1. **–î–æ–±–∞–≤—å—Ç–µ GitHub Secrets:**
   - `SERVER_HOST` - IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
   - `SERVER_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH
   - `SERVER_SSH_KEY` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
export BOT_TOKEN="your-bot-token"
export ADMIN_CHAT_ID="your-admin-chat-id"
export GITHUB_REPOSITORY="your-username/your-repo"
```

3. **–ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π:**
```bash
./deploy.sh deploy
```

## üìã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
./build-and-run.sh full

# –¢–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞
./build-and-run.sh build

# –¢–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫
./build-and-run.sh run

# –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π
./build-and-run.sh preload small,medium

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./build-and-run.sh logs

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./build-and-run.sh stop
```

### –°–µ—Ä–≤–µ—Ä–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å latest –≤–µ—Ä—Å–∏—é
./deploy.sh deploy

# –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é
./deploy.sh deploy v1.2.3

# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
./deploy.sh rollback v1.2.2

# –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–∑ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
./deploy.sh update

# –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª–∏
./deploy.sh preload small,medium

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
./deploy.sh status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
./deploy.sh logs
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
|------------|----------|-------------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | –î–∞ |
| `ADMIN_CHAT_ID` | ID —á–∞—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ | –ù–µ—Ç |
| `WHISPER_PRELOAD_MODELS` | –ú–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ | –ù–µ—Ç |
| `WHISPER_DEVICE` | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è Whisper (cpu/cuda) | –ù–µ—Ç |
| `WHISPER_COMPUTE_TYPE` | –¢–∏–ø –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (int8/float16) | –ù–µ—Ç |

### –ú–æ–¥–µ–ª–∏ Whisper

–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏: `tiny`, `base`, `small`, `medium`, `large-v1`, `large-v2`, `large-v3`

–ü—Ä–∏–º–µ—Ä –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏:
```bash
WHISPER_PRELOAD_MODELS="small,medium" ./deploy.sh deploy
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check
```bash
curl http://localhost:8080/actuator/health
```

### –ú–µ—Ç—Ä–∏–∫–∏
```bash
curl http://localhost:8080/actuator/metrics
```

### –õ–æ–≥–∏
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
./build-and-run.sh logs

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
./deploy.sh logs
```

## üê≥ Docker

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞
```bash
docker-compose build
docker-compose up -d
```

### Production
```bash
docker-compose -f docker-compose.prod.yml up -d
```

## üîÑ CI/CD Workflow

1. **Push –≤ main/master** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
2. **GitHub Actions** —Å–æ–±–∏—Ä–∞–µ—Ç JAR –∏ Docker –æ–±—Ä–∞–∑
3. **–û–±—Ä–∞–∑ –ø—É—à–∏—Ç—Å—è** –≤ GitHub Container Registry
4. **–°–µ—Ä–≤–µ—Ä** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π
```bash
# –í GitHub: Actions ‚Üí Deploy to Server ‚Üí Run workflow
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Bot/
‚îú‚îÄ‚îÄ src/main/java/          # Java –∫–æ–¥
‚îú‚îÄ‚îÄ src/main/resources/     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ Python —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ build.gradle           # Gradle –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile             # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml     # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ docker-compose.prod.yml # Production
‚îú‚îÄ‚îÄ build-and-run.sh       # –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ deploy.sh              # –°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îî‚îÄ‚îÄ .github/workflows/     # CI/CD
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

1. –†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ —Å `./build-and-run.sh`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. Commit –∏ push –≤ main
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –û—Ç–ª–∞–¥–∫–∞

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
./build-and-run.sh logs

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
./deploy.sh logs
docker-compose -f docker-compose.prod.yml logs -f bot
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ GitHub Secrets
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- Health checks –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–∫–∞—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è —Å–±–æ—Ä–∫–∞ Docker
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Whisper
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JVM –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `./deploy.sh logs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `./deploy.sh status`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check: `curl http://localhost:8080/actuator/health`
4. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ GitHub
